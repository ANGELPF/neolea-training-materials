% DO NOT COMPILE THIS FILE DIRECTLY!
% This is included by the other .tex files.


\begin{frame}
    \includegraphics[scale=0.3]{images/logo-circl-Forensics.png}
    \begin{itemize}
        \item[]
        \item[]
        \item[] 8. Carving
    \end{itemize}
\end{frame}


\begin{frame}[fragile]
  \frametitle{8.1 Magic Bytes - File signatures}
  \begin{lstlisting}[basicstyle=\tiny]
xxd logo_h4k-350x250.jpg | less
0000000: ffd8 ffe0 0010 4a46 4946 0001 0100 0001  ......JFIF......
...
...
0008cc0: 0fa5 0a28 141a 0028 a0d0 3a50 07ff d9    ...(...(..:P...




xxd cases.jpg | less
0000000: ffd8 ffe1 0018 4578 6966 0000 4949 2a00  ......Exif..II*.
...
...
0001730: 4028 0500 a014 0280 501f ffd9            @(......P...




/etc/scalpel/scalpel.conf
-------------------------

   jpg     y     200000000     \xff\xd8\xff\xe0\x00\x10     \xff\xd9
   jpg     y     200000000     \xff\xd8\xff\xe1             \xff\xd9

  \end{lstlisting}
\end{frame}


\begin{frame}[fragile]
  \frametitle{8.1 Magic Bytes - File signatures}
  \begin{lstlisting}[basicstyle=\tiny]
xxd MECO-SMILE.pdf | less
0000000: 2550 4446 2d31 2e34 0a25 c7ec 8fa2 0a35  %PDF-1.4.%.....5
...
...
005c4d0: 3431 390a 2525 454f 460a                 419.%%EOF.




xxd LU-NCSS-2-EN.pdf | less
00000000: 2550 4446 2d31 2e35 0d25 e2e3 cfd3 0d0a  %PDF-1.5.%......
...
...
0007a7e0: 6566 0d31 3136 0d25 2545 4f46 0d         ef.116.%%EOF.




/etc/scalpel/scalpel.conf
-------------------------

   pdf     y       5000000     %PDF     %EOF\x0d     REVERSE
   pdf     y       5000000     %PDF     %EOF\x0a     REVERSE

  \end{lstlisting}
\end{frame}


\begin{frame}[fragile]
  \frametitle{8.2 Carving tools}
    \begin{itemize}
        \item Foremost
            \begin{itemize}
                \item Version 1.5.7
            \end{itemize}
        \item Scalpel
            \begin{itemize}
                \item Version 1.60
                \item Based on Foremost 0.69
            \end{itemize}
        \item Bulk Extractor
            \begin{itemize}
                \item Emails, Email addresses
                \item URLs
                \item Credit card numbers
                \item Social media
                \item Telephone numbers
                \item ...
            \end{itemize}
        \item Testdisk - Photorec
    \end{itemize}
\end{frame}


\begin{frame}[fragile]
    \frametitle{8.3 Exercise: Recover data from formated drive}
    \begin{itemize}
	\item Try meta data based recovery with \texttt{fls}
        \item Carving formated drive
        \begin{lstlisting}[basicstyle=\tiny]
mkdir out1/
foremost -t all -i formated.dd -o out1/

out1/audit.txt
--------------

File: deleted.dd
Start: Wed Aug 22 16:20:43 2018
Length: 32 MB (33554432 bytes)

Num      Name (bs=512)         Size      File Offset     Comment
0:      00009032.jpg           5 KB         4624384
1:      00009080.jpg          35 KB         4648960
2:      00037617.jpg          30 KB        19260232
3:      00037678.jpg         106 KB        19291633
.....
16:     00037608.pdf           1 MB        19255296
17:     00041288.pdf         489 KB        21139456       (PDF is Linearized)
Finish: Wed Aug 22 16:20:43 2018
18 FILES EXTRACTED

jpg:= 9
png:= 6
pdf:= 3
        \end{lstlisting}
    \end{itemize}
\end{frame}





